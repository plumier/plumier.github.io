(self.webpackChunkplumier_docs=self.webpackChunkplumier_docs||[]).push([[886],{876:function(e,t,n){"use strict";n.d(t,{Zo:function(){return m},kt:function(){return c}});var r=n(2784);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},m=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=s(n),c=a,k=u["".concat(p,".").concat(c)]||u[c]||d[c]||i;return n?r.createElement(k,l(l({ref:t},m),{},{components:n})):r.createElement(k,l({ref:t},m))}));function c(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=u;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},5653:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return o},metadata:function(){return p},toc:function(){return s},default:function(){return d}});var r=n(7560),a=n(8283),i=(n(2784),n(876)),l=["components"],o={id:"plumier-in-five-minutes",title:"Plumier in Five Minutes"},p={unversionedId:"plumier-in-five-minutes",id:"plumier-in-five-minutes",isDocsHomePage:!1,title:"Plumier in Five Minutes",description:"Plumier is A TypeScript backend framework focuses on development productivity to help you create a robust, secure and fast Node.js restful API delightfully. Plumier shipped with some built-in feature to speed up your API development.",source:"@site/docs/Plumier-In-Five-Minutes.md",sourceDirName:".",slug:"/plumier-in-five-minutes",permalink:"/plumier-in-five-minutes",editUrl:"https://github.com/plumier/plumier/edit/master/docs/docusaurus/docs/Plumier-In-Five-Minutes.md",version:"current",frontMatter:{id:"plumier-in-five-minutes",title:"Plumier in Five Minutes"},sidebar:"overview",next:{title:"Quick Start",permalink:"/quick-start"}},s=[{value:"First Class Entity",id:"first-class-entity",children:[]},{value:"Validators",id:"validators",children:[]},{value:"Common Controller",id:"common-controller",children:[]},{value:"Open API 3.0",id:"open-api-30",children:[]},{value:"Facilities",id:"facilities",children:[]},{value:"Code Style",id:"code-style",children:[]}],m={toc:s};function d(e){var t=e.components,o=(0,a.Z)(e,l);return(0,i.kt)("wrapper",(0,r.Z)({},m,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Plumier is A TypeScript backend framework focuses on development productivity to help you create a robust, secure and fast Node.js restful API delightfully. Plumier shipped with some built-in feature to speed up your API development."),(0,i.kt)("h2",{id:"first-class-entity"},"First Class Entity"),(0,i.kt)("p",null,"A first class entity is an ORM Entity with control to most framework functionalities (validation, authorization, data type schema, generated restful API). On the background Plumier creates a generic controller on the fly for each first class entity to create CRUD restful API for each entity."),(0,i.kt)("h4",{id:"simplest-first-class-entity"},"Simplest First Class Entity"),(0,i.kt)("p",null,"Plumier supported TypeORM entity to be used as first class entity, simplest implementation of first class entity is like below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{6}","{6}":!0},'import { route, val} from "plumier";\nimport { Column, Entity, PrimaryGeneratedColumn } from "typeorm";\n\n// create generic controller based on Item entity on the fly.\n// handles restful API post, put, patch, delete, get (by id), get (list)\n@genericController()\n@Entity()\nexport class Item {\n    @PrimaryGeneratedColumn()\n    id: number;\n\n    @Column()\n    name: string;\n\n    @Column()\n    basePrice: number;\n\n    @Column()\n    price: number;\n}\n')),(0,i.kt)("p",null,"Above code generated into six restful routes like below."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Method"),(0,i.kt)("th",{parentName:"tr",align:null},"Path"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"POST"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/items")),(0,i.kt)("td",{parentName:"tr",align:null},"Create new item")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"GET"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/items")),(0,i.kt)("td",{parentName:"tr",align:null},"Get list of items with paging, filter, order and projection")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"GET"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/items/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Get single item by id with projection")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"PUT"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/items/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Replace item by id")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/items/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Modify item by id (required validation ignored)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/items/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Delete item by id")))),(0,i.kt)("h4",{id:"nested-restful-api"},"Nested Restful API"),(0,i.kt)("p",null,"ORM entities may contains relations to represent join to another table, Plumier provided nested generic controller to perform parent children operation."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{11}","{11}":!0},'import { route } from "plumier"\nimport { Entity, OneToMany, PrimaryGeneratedColumn } from "typeorm"\n\n@Entity()\nexport class Post {\n    @PrimaryGeneratedColumn()\n    id: number\n\n    /** other properties **/\n\n    @genericController()\n    @OneToMany(x => Comment, x => x.post)\n    comments: Comment[]\n}\n\n@Entity()\nexport class Comment {\n    @PrimaryGeneratedColumn()\n    id: number\n\n    @Column()\n    comment:string\n\n    @ManyToOne(x => Post, x => x.comments)\n    post:Post\n}\n')),(0,i.kt)("p",null,"Above code showing that the relation property ",(0,i.kt)("inlineCode",{parentName:"p"},"comments")," marked with ",(0,i.kt)("inlineCode",{parentName:"p"},"@genericController()")," decorators. It tells Plumier to create a nested generic controller to perform parent children operation. Above code will generated into routes below."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Method"),(0,i.kt)("th",{parentName:"tr",align:null},"Path"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"POST"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/posts/:pid/comments")),(0,i.kt)("td",{parentName:"tr",align:null},"Create new post's comment")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"GET"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/posts/:pid/comments")),(0,i.kt)("td",{parentName:"tr",align:null},"Get list of post's comments with paging, filter, order and projection")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"GET"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/posts/:pid/comments/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Get single post's comment by id with projection")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"PUT"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/posts/:pid/comments/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Replace post's comment  by id")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"PATCH"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/posts/:pid/comments/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Modify post's comment property by id")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"DELETE"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"/posts/:pid/comments/:id")),(0,i.kt)("td",{parentName:"tr",align:null},"Delete post's comment by id")))),(0,i.kt)("h4",{id:"first-class-entity-security"},"First Class Entity Security"),(0,i.kt)("p",null,"Entities may contains properties that sensitive to some type of users, you may need to restrict user to access specific API endpoint or even you may need to restrict user to set/see specific property on request or response body. "),(0,i.kt)("p",null,"Plumier provided declarative authorization by specifying authorization policy name that can be applied to secure API endpoints, property of request/response body etc. Furthermore you define the authorization policy logic separately."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{4,15,20}","{4,15,20}":!0},'@genericController((config) => {\n    // authorize Supervisor and Staff \n    // can mutate (post, put, patch, delete) the resource\n    config.mutators().authorize("Supervisor", "Staff");\n})\n@Entity()\nexport class Item {\n    @PrimaryGeneratedColumn()\n    id: number;\n\n    @Column()\n    name: string;\n\n    // authorize response body property only can be seen by Supervisor and Staff \n    @authorize.read("Supervisor", "Staff")\n    @Column()\n    basePrice: number;\n\n    // authorize request body property only can be set by Supervisor and Staff \n    @authorize.write("Supervisor")\n    @Column()\n    price: number;\n}\n')),(0,i.kt)("p",null,"Code above showing that ",(0,i.kt)("inlineCode",{parentName:"p"},"Supervisor")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Staff")," is an authorization policy. Next you define your authorization policy logic using authorization policy builder like below. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { authPolicy } from "plumier"\n\n// register policies (role) with authorization policy builder\nauthPolicy()\n    // register Supervisor\n    .register("Supervisor", ({ user }) => {\n        // user is the JWT claim from request header\n        return user?.role === "Supervisor"\n    })\n    // register Staff\n    .register("Staff", ({ user }) => {\n        return user?.role === "Staff"\n    })\n')),(0,i.kt)("p",null,"You register the authorization policy by providing the policy name and an authorization callback. The callback will be called during authorization evaluation. "),(0,i.kt)("h4",{id:"auto-generated-values"},"Auto Generated Values"),(0,i.kt)("p",null,"Entities may contains properties that is auto generated, such as ",(0,i.kt)("inlineCode",{parentName:"p"},"createdBy")," property that needs to automatically assigned with the current login user ID. "),(0,i.kt)("p",null,"Furthermore you may need to restrict anyone to set the ",(0,i.kt)("inlineCode",{parentName:"p"},"createdBy")," property from the request body."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'@genericController()\n@Entity()\nexport class Item {\n    @PrimaryGeneratedColumn()\n    id: number;\n\n    // restrict user to set property from request body\n    @authorize.readonly()\n    // created date column provided by TypeORM\n    @CreateDateColumn()\n    createdAt: Date\n    \n    // restrict user to set property from request body\n    @authorize.readonly()\n    @Column()\n    createdBy:User\n\n    // executed method before entity saved, only on post request\n    @preSave("post")\n    // bind user parameter with the JWT claim from request header\n    assignUser(@bind.user() user:LoginUser){\n        // assign createdBy with current login user from JWT claim\n        this.createdBy = <User>{ id: user.userId }\n    }\n}\n')),(0,i.kt)("p",null,"Code above showing that we use the request hook ",(0,i.kt)("inlineCode",{parentName:"p"},"@preSave()")," to make the ",(0,i.kt)("inlineCode",{parentName:"p"},"assignUser")," method executed before the entity being saved to the database. "),(0,i.kt)("h4",{id:"define-filterable-fields"},"Define Filterable Fields"),(0,i.kt)("p",null,"Generic controller provided functionalities to refine the API response, such as filter, paging, order and projection. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { route, authorize } from "plumier"\nimport { Entity, Column, CreateDateColumn, PrimaryGeneratedColumn } from "typeorm"\n\n@genericController()\n@Entity()\nexport class Post {\n    @PrimaryGeneratedColumn()\n    id: number\n\n    @Column()\n    slug:string\n\n    @Column()\n    title:string\n\n    @Column()\n    content:string\n\n    @CreateDateColumn()\n    createdAt:Date\n}\n')),(0,i.kt)("p",null,"Using above code we can query filter for all Post fields. Using above generated API you may request like below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# Filter response based on slug property using equals comparison\nGET /posts?filter=(slug = 'my_cool_post')\n\n# Perform range filter between dates using triple dots\nGET /posts?filter=(createdAt = '2020-9-1'...'2020-10-1')\n\n# Perform conditional filter \nGET /posts?filter=(createdAt >= '2020-9-1' and deleted = false)\n\n# Perform search on title that starts with word programming using asterisk\nGET /posts?filter=(title = 'programming'*)\n")),(0,i.kt)("p",null,"Filter will follows the ",(0,i.kt)("inlineCode",{parentName:"p"},"@authorize.read()")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"@authorize.writeonly()")," respectively. Its mean when user doesn't have proper read access the query will returned 401."),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"documentation")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"For more information about first class entity and generic controller can be found ",(0,i.kt)("a",{parentName:"p",href:"/generic-controller"},"here")))),(0,i.kt)("h2",{id:"validators"},"Validators"),(0,i.kt)("p",null,"Plumier provided comprehensive list of validator, uses ",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/validator"},"ValidatorJS")," internally. You specify validation using ",(0,i.kt)("inlineCode",{parentName:"p"},"@val")," decorator. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{9-11,15,19}","{9-11,15,19}":!0},'import { val } from "plumier"\nimport { Entity, Column, CreateDateColumn, PrimaryGeneratedColumn } from "typeorm"\n\n@Entity()\nexport class User {\n    @PrimaryGeneratedColumn()\n    id: number\n\n    @val.email()\n    @val.unique()\n    @val.required()\n    @Column()\n    email: string\n\n    @val.required()\n    @Column()\n    name:string\n\n    @val.url()\n    @Column()\n    profilePicture:string\n}\n')),(0,i.kt)("p",null,"There are more than 40 validators to use to secure your API consumer request. "),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"documentation")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Refer to ",(0,i.kt)("a",{parentName:"p",href:"/validation"},"validator documentation")," for more information "))),(0,i.kt)("h2",{id:"common-controller"},"Common Controller"),(0,i.kt)("p",null,"Generic controller is just an implementation of Plumier controller with generic class signature. Even though generic controller can be fully customized to match your app requirements, in some case its may required to use a controller manually to handle user request. "),(0,i.kt)("p",null,"The term of Controller in Plumier is the same as in other MVC framework. Plumier controller is a plain class end with ",(0,i.kt)("inlineCode",{parentName:"p"},"Controller")," for example ",(0,i.kt)("inlineCode",{parentName:"p"},"class UsersController"),". A route automatically generated based on ",(0,i.kt)("inlineCode",{parentName:"p"},"/controller/action"),". This behavior can be customized using ",(0,i.kt)("inlineCode",{parentName:"p"},"@route")," decorator."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { route } from "plumier"\n\nexport class UsersController {\n    // GET /users/:id\n    @route.get(":id")\n    get(id:string) { \n\n      // return value or Promise that \n      // automatically rendered into JSON response\n      return repo.findOne(id)\n    }\n}\n')),(0,i.kt)("p",null,"Controller can return any value including ",(0,i.kt)("inlineCode",{parentName:"p"},"Promise"),", this value then rendered into JSON response automatically. You can have more control to the response by returning the ",(0,i.kt)("inlineCode",{parentName:"p"},"ActionResult")," or use the built-in ",(0,i.kt)("inlineCode",{parentName:"p"},"response")," function."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Action"),(0,i.kt)("th",{parentName:"tr",align:null},"Alias"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Package"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ActionResult")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"response.json()")),(0,i.kt)("td",{parentName:"tr",align:null},"Return json response"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"RedirectActionResult")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"response.redirect()")),(0,i.kt)("td",{parentName:"tr",align:null},"Redirect response"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"FileActionResult")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"response.file()")),(0,i.kt)("td",{parentName:"tr",align:null},"Serve static file response"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@plumier/serve-static"))))),(0,i.kt)("h4",{id:"bind-request-part-into-actions-parameter"},"Bind Request Part Into Action's Parameter"),(0,i.kt)("p",null,"Action parameter can be bound into request part such as query, body, header etc. Request values received automatically converted into data type match with action parameter data type. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { route } from "plumier"\n\nexport class UsersController {\n    // GET /users/list\n    @route.get()\n    list(offset:number = 0, limit:number = 50, active:boolean = true) {\n        \n    }\n}\n')),(0,i.kt)("p",null,"Above controller generated into ",(0,i.kt)("inlineCode",{parentName:"p"},"GET /users/list?limit&offset&active"),". All parameters are optional with their default values. Note that the value automatically converted match with parameter data type, giving these request are valid"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"GET /users/list \nGET /users/list?limit=20\nGET /users/list?offset=20&limit=20\nGET /users/list?offset=10&active=true\nGET /users/list?active=1\n")),(0,i.kt)("p",null,"Important to notice that boolean parameter can be filled with: ",(0,i.kt)("inlineCode",{parentName:"p"},"yes"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"no"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"0"),". And parameter of type datetime can be filled with ",(0,i.kt)("inlineCode",{parentName:"p"},"2020-12-31")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"2020-10-05T23:28:33.598Z")," "),(0,i.kt)("p",null,"Parameters also can be bound with request body by providing a parameter of type of custom object to hold the request body like example below"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { route, domain } from "plumier"\n\n@domain()\nexport class Login {\n    constructor(\n        public email:string,\n        public password:string,\n    ){}\n}\n\nexport class AuthController {\n    // POST /auth/login\n    @route.post()\n    login(data:Login) {\n        \n    }\n}\n')),(0,i.kt)("p",null,"Above controller will be generated into ",(0,i.kt)("inlineCode",{parentName:"p"},"POST /auth/login")," with request body ",(0,i.kt)("inlineCode",{parentName:"p"},'{ "email":<string>, "password": <string> }')," "),(0,i.kt)("p",null,"Plumier provided decorators to bind specific request body to parameter, you can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"@bind")," decorator on specific parameter. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{6}","{6}":!0},'import { route, bind } from "plumier"\n\nexport class UsersController {\n    // GET /users/:id\n    @route.get(":id")\n    get(id:string, @bind.user() user:LoginUser) { }\n}\n')),(0,i.kt)("p",null,"Here are list of supported parameter binding decorators "),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Binding"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.user()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind current login user (JWT claims) into parameter")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.ctx()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind request context into parameter")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.request()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind request into parameter")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.body()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind request body into parameter (optional, or use a custom class type to automatically bind request body to parameter)")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.query()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind request query into parameter")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.header()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind request header into parameter")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.cookie()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind request cookie into parameter")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@bind.custom()")),(0,i.kt)("td",{parentName:"tr",align:null},"Bind custom parameter binding implementation into parameter")))),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"documentation")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Refer to the complete documentation about ",(0,i.kt)("a",{parentName:"p",href:"/controller"},"controller")," "))),(0,i.kt)("h2",{id:"open-api-30"},"Open API 3.0"),(0,i.kt)("p",null,"Plumier provided ",(0,i.kt)("inlineCode",{parentName:"p"},"SwaggerFacility")," to automatically generate Open API 3.0 schema from both controller and generic controller. Open API 3.0 Schema automatically generated by reading and transforming controller's metadata on the fly. "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript",metastring:"{5}","{5}":!0},'import { SwaggerFacility } from "@plumier/swagger"\n\nnew Plumier()\n  /* other facilities */\n  .set(new SwaggerFacility()) \n')),(0,i.kt)("p",null,"The generated Open API 3.0 schema can be customized minimally, but mostly everything will just work out of the box. ",(0,i.kt)("inlineCode",{parentName:"p"},"SwaggerFacility")," hosts the SwaggerUI under ",(0,i.kt)("inlineCode",{parentName:"p"},"/swagger")," endpoint."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"swagger",src:n(7219).Z})),(0,i.kt)("h2",{id:"facilities"},"Facilities"),(0,i.kt)("p",null,"The entry point of Plumier application is an instance of ",(0,i.kt)("inlineCode",{parentName:"p"},"Plumier"),". ",(0,i.kt)("inlineCode",{parentName:"p"},"Plumier")," consist of features that can be enabled/disabled by installing ",(0,i.kt)("inlineCode",{parentName:"p"},"Facility"),". "),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},'import { JwtAuthFacility } from "@plumier/jwt"\nimport { SwaggerFacility } from "@plumier/swagger"\nimport { TypeORMFacility } from "@plumier/typeorm"\nimport Plumier, { WebApiFacility } from "plumier"\n\nnew Plumier()\n    .set(new WebApiFacility())\n    .set(new JwtAuthFacility())\n    .set(new TypeORMFacility())\n    .set(new SwaggerFacility())\n    .listen(8000);\n')),(0,i.kt)("p",null,"Above code will start Plumier application with some installed features and listens to the port 8000. Plumier provided some facilities for development convenient they are:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Facility"),(0,i.kt)("th",{parentName:"tr",align:null},"Includes"),(0,i.kt)("th",{parentName:"tr",align:null},"Package"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"WebApiFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Body parser, CORS middleware, Default dependency resolver"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"RestApiFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Same as ",(0,i.kt)("inlineCode",{parentName:"td"},"WebApiFacility")," except its provided more strict restful API status code"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ControllerFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Host controllers by path or type, furthermore controllers can be grouped and versioned"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"LoggerFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Simple request logging and error reporting"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"JwtAuthFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Jwt middleware, Enable authorization, Jwt Secret configuration"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@plumier/jwt"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"MongooseFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Mongoose schema generator, generic controller and connection management"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@plumier/mongoose"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"TypeORMFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Provided helper and generic controller for TypeORM"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@plumier/typeorm"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"ServeStaticFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Serve static files middleware"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@plumier/serve-static"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"SwaggerFacility")),(0,i.kt)("td",{parentName:"tr",align:null},"Serve Swagger UI and generate Open API 3.0 automatically"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"@plumier/swagger"))))),(0,i.kt)("h2",{id:"code-style"},"Code Style"),(0,i.kt)("p",null,"Plumier doesn't strictly provided the project layout, but it provided flexibility to layout your project files match your need. Below are some common project structure usually used by developers, You can choose any of them match your like."),(0,i.kt)("h4",{id:"single-file-style"},"Single File Style"),(0,i.kt)("p",null,"This style usually used by Express for small app with a fewer code. Put all controllers and entities in a single file and configure the bootstrap application like below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"new Plumier()\n    .set(new WebApiFacility())\n    .listen(8000)\n")),(0,i.kt)("h4",{id:"classic-mvc-style"},"Classic MVC Style"),(0,i.kt)("p",null,"This is default style supported by Plumier. Classic MVC style app separate project files by functionalities such as ",(0,i.kt)("inlineCode",{parentName:"p"},"controllers"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"models"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"repositories"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"entities"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"services")," etc."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"+ src/\n  + controller/\n    - item.controller.ts\n    - user.controller.ts\n  + repository/\n    - item.repository.ts\n    - user.repository.ts\n  + service/\n    - item.service.ts\n    - user.service.ts\n  + entity/\n    - item.entity.ts\n    - user.entity.ts\n  - app.ts\n  - index.ts\n- package.json\n- tsconfig.json\n")),(0,i.kt)("p",null,"No more setup required to use this style."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"new Plumier()\n    .set(new WebApiFacility())\n    .listen(8000)\n")),(0,i.kt)("h4",{id:"modular-style"},"Modular Style"),(0,i.kt)("p",null,"This style usually used by modern frameworks, files separated by module per directory, each directory consist of controller, model, service, entity etc separated in different files. "),(0,i.kt)("p",null,"To use this style you must follow the file name convention by creating file ends with ",(0,i.kt)("inlineCode",{parentName:"p"},"controller")," word like below."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"+ src/\n  + item/\n    - item.controller.ts\n    - item.entity.ts\n    - item.service.ts\n    - item.repository.ts\n  + user/\n    - user.controller.ts\n    - user.entity.ts\n    - user.service.ts\n    - user.repository.ts\n  - app.ts\n  - index.ts\n- package.json\n- tsconfig.json\n")),(0,i.kt)("p",null,"No more setup required to use this style, Plumier will automatically search through all files to find controllers."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"new Plumier()\n    .set(new WebApiFacility())\n    .listen(8000)\n")))}d.isMDXComponent=!0},7219:function(e,t,n){"use strict";t.Z=n.p+"assets/images/swagger-a3e6e8c80d9743ab587b918badc447e7.png"}}]);