(self.webpackChunkplumier_docs=self.webpackChunkplumier_docs||[]).push([[534],{876:function(e,t,n){"use strict";n.d(t,{Zo:function(){return d},kt:function(){return u}});var r=n(2784);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=r.createContext({}),c=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=c(e.components);return r.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},s=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,p=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),s=c(n),u=i,k=s["".concat(p,".").concat(u)]||s[u]||m[u]||a;return n?r.createElement(k,l(l({ref:t},d),{},{components:n})):r.createElement(k,l({ref:t},d))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,l=new Array(a);l[0]=s;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,l[1]=o;for(var c=2;c<a;c++)l[c]=n[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}s.displayName="MDXCreateElement"},5112:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return o},metadata:function(){return p},toc:function(){return c},default:function(){return m}});var r=n(7560),i=n(8283),a=(n(2784),n(876)),l=["components"],o={id:"entry-point",title:"Entry Point"},p={unversionedId:"entry-point",id:"entry-point",isDocsHomePage:!1,title:"Entry Point",description:"Plumier application is the entry point of all Plumier based API. Creating Plumier application simply by creating instance of Plumier class. The simplest Plumier application at least must have WebApiFacility installed like below.",source:"@site/docs/Entry-Point.md",sourceDirName:".",slug:"/entry-point",permalink:"/entry-point",editUrl:"https://github.com/plumier/plumier/edit/master/docs/docusaurus/docs/Entry-Point.md",version:"current",frontMatter:{id:"entry-point",title:"Entry Point"},sidebar:"overview",previous:{title:"Quick Start",permalink:"/quick-start"},next:{title:"Controller",permalink:"/controller"}},c=[{value:"Facilities",id:"facilities",children:[]},{value:"Application For Testing",id:"application-for-testing",children:[]}],d={toc:c};function m(e){var t=e.components,n=(0,i.Z)(e,l);return(0,a.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Plumier application is the entry point of all Plumier based API. Creating Plumier application simply by creating instance of ",(0,a.kt)("inlineCode",{parentName:"p"},"Plumier")," class. The simplest Plumier application at least must have ",(0,a.kt)("inlineCode",{parentName:"p"},"WebApiFacility")," installed like below."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import Plumier from "plumier"\n\nnew Plumier()\n    .set(new WebApiFacility())\n    .listen(8000)\n')),(0,a.kt)("p",null,"By default Plumier will search for controllers using this glob pattern ",(0,a.kt)("inlineCode",{parentName:"p"},"./**/*controller.+(ts|js)")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"./**/*entity.+(ts|js)"),", its mean it will search for all TypeScript/JavaScript files ends with ",(0,a.kt)("inlineCode",{parentName:"p"},"controller")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"entity")," (for first class entity). It also automatically detected exported controller in the same file with the entry point file, this is useful for single file project. "),(0,a.kt)("p",null,"Above configuration does noting because no controller specified. We can start above code using ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/ts-node"},"ts-node")," or ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/ts-node-dev"},"ts-node-dev"),", by specify it on the ",(0,a.kt)("inlineCode",{parentName:"p"},"package.json")," script like below."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json",metastring:"{5}","{5}":!0},'{\n  "name": "my-cool-api",\n  "version": "1.0.0",\n  "scripts": {\n    "debug": "ts-node-dev --inspect -- src/index",\n    "build": "tsc",\n    "start": "node src/index"\n  },\n  "dependencies": {\n    "plumier": "^1.0.0-rc.7",\n  },\n  "devDependencies": {\n    "ts-node-dev": "^1.1.1",\n    "typescript": "^4.1.3",\n  }\n}\n')),(0,a.kt)("h2",{id:"facilities"},"Facilities"),(0,a.kt)("p",null,"Plumier application is configurable using facility, facility is a framework component consist of configurations, ordered middlewares and some micro process before the framework started."),(0,a.kt)("p",null,"There are list of built-in facility that ready to be used."),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Facility"),(0,a.kt)("th",{parentName:"tr",align:null},"Includes"),(0,a.kt)("th",{parentName:"tr",align:null},"Package"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"WebApiFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Body parser, CORS middleware, Default dependency resolver"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"RestApiFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Same as ",(0,a.kt)("inlineCode",{parentName:"td"},"WebApiFacility")," except its provided more strict restful API status code"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ControllerFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Host controllers by path or type, furthermore controllers can be grouped and versioned"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"LoggerFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Simple request logging and error reporting"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"plumier"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"JwtAuthFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Jwt middleware, Enable authorization, Jwt Secret configuration"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/jwt"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"MongooseFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Mongoose schema generator, generic controller and connection management"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/mongoose"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"TypeORMFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Provided helper and generic controller for TypeORM"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/typeorm"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"ServeStaticFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Serve static files"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/serve-static"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"SwaggerFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Serve Swagger UI and generate Open API 3.0 automatically"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/swagger"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"FacebookOAuthFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Provide Facebook specific social login functionalities"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/social-login"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"GoogleOAuthFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Provide Google specific social login functionalities"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/social-login"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"GitHubOAuthFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Provide GitHub specific social login functionalities"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/social-login"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"GitLabOAuthFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Provide GitLab specific social login functionalities"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/social-login"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"TwitterOAuthFacility")),(0,a.kt)("td",{parentName:"tr",align:null},"Provide Twitter specific social login functionalities"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"@plumier/social-login"))))),(0,a.kt)("h2",{id:"application-for-testing"},"Application For Testing"),(0,a.kt)("p",null,"When Plumier ",(0,a.kt)("inlineCode",{parentName:"p"},"listen")," method called immediately its make Plumier lost its ability for testing purpose. To do that you can use ",(0,a.kt)("inlineCode",{parentName:"p"},"initialize")," method to get a testable server like below. "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import Plumier, { Configuration, WebApiFacility } from "plumier"\n\nfunction createApp(config?: Partial<Configuration>) {\n    return new Plumier()\n        // specify the rootDir since it will be executed in different directory (test dir)\n        .set({ ...config, rootDir: __dirname })\n        .set(new WebApiFacility())\n        .initialize()\n}\n\nexport default createApp\n')),(0,a.kt)("p",null,"By using code above, you can test your API using ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/supertest"},"supertest")," like below."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import createApp from "../src/app"\nimport supertest from "supertest"\n\nit("Should serve API properly", async () => {\n    const app = await createApp({ mode: "production" })\n    await supertest(app.callback())\n        .get("/")\n        .expect(200)\n})\n')))}m.isMDXComponent=!0}}]);