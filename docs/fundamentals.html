<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Fundamentals · Plumier</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This documentation covers all the basic features of Plumier. By reading this documentation you will get the basic understanding on how the framework work."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Fundamentals · Plumier"/><meta property="og:type" content="website"/><meta property="og:url" content="https://plumierjs.com/"/><meta property="og:description" content="This documentation covers all the basic features of Plumier. By reading this documentation you will get the basic understanding on how the framework work."/><meta property="og:image" content="https://plumierjs.com/img/plumier-black.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://plumierjs.com/img/plumier-black.png"/><link rel="shortcut icon" href="/img/plumier.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/plumier.svg" alt="Plumier"/><h2 class="headerTitleWithLogo">Plumier</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/overview" target="_self">Docs</a></li><li class=""><a href="/docs/tutorials/basic-sql/get-started" target="_self">Tutorials</a></li><li class=""><a href="https://github.com/plumier/plumier" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Overview</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Overview<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/motivation">Motivation</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/fundamentals">Fundamentals</a></li><li class="navListItem"><a class="navItem" href="/docs/extend">Extending Plumier</a></li><li class="navListItem"><a class="navItem" href="/docs/project-template">Project Template</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">References<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/refs/entry-point">Application Startup</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/controller">Controller</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/route">Route Cheat Sheet</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/parameter-binding">Parameter Binding</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/action-result">ActionResult</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/converters">Converters</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/validation">Validation</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/authorization">Authorization</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/middleware">Middleware</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/facility">Facility</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/error-handling">Error Handling</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/serve-static">Serve Static Files</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/file-upload">File Upload</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/mongoose-helper">Mongoose Helper</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/social-login">Social Media Login</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/controller-invoker">Controller Invoker</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/testing-tips">Testing Tips</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/static-analysis">Static Analysis</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/metaprogramming">Metaprogramming</a></li><li class="navListItem"><a class="navItem" href="/docs/refs/application-lifecycle">Application Lifecycle</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Extend<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/extends/custom-parameter-binding">Custom Parameter Binding</a></li><li class="navListItem"><a class="navItem" href="/docs/extends/custom-validator">Custom Validator</a></li><li class="navListItem"><a class="navItem" href="/docs/extends/custom-authorization">Custom Authorization</a></li><li class="navListItem"><a class="navItem" href="/docs/extends/custom-dependency-resolver">Custom Dependency Resolver</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Fundamentals</h1></header><article><div><span><p>This documentation covers all the basic features of Plumier. By reading this documentation you will get the basic understanding on how the framework work.</p>
<h2><a class="anchor" aria-hidden="true" id="basic-framework-skeleton"></a><a href="#basic-framework-skeleton" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Framework Skeleton</h2>
<p>The simplest Plumier application consist of two parts: <strong>Application bootstrap</strong> and a <strong>controller</strong>. This simple application can be written in single TypeScript file like below:</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">import</span> Plumier, { WebApiFacility } <span class="hljs-keyword">from</span> <span class="hljs-string">"plumier"</span>

<span class="hljs-comment">// controller</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> HelloController {
    index(name:<span class="hljs-built_in">string</span>) {
        <span class="hljs-keyword">return</span> { say: <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>`</span> }
    }
}

<span class="hljs-comment">// application bootstrap</span>
<span class="hljs-keyword">new</span> Plumier()
    .set(<span class="hljs-keyword">new</span> WebApiFacility({ controller: __filename }))
    .initialize()
    .then(<span class="hljs-function"><span class="hljs-params">koa</span> =&gt;</span> koa.listen(<span class="hljs-number">8000</span>))
    .catch(<span class="hljs-built_in">console</span>.error)
</code></pre>
<p>Above code host an API listens to port 8000 and serve an endpoint <code>GET /hello/index?name=&lt;string&gt;</code>.</p>
<h2><a class="anchor" aria-hidden="true" id="minimum-typescript-configuration"></a><a href="#minimum-typescript-configuration" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Minimum TypeScript Configuration</h2>
<p>To be able to run the Plumier application properly, some TypeScript option need to be enabled. Below is minimum required configuration to be able to run Plumier application properly.</p>
<pre><code class="hljs css language-json">{
  <span class="hljs-attr">"compilerOptions"</span>: {
    <span class="hljs-attr">"target"</span>: <span class="hljs-string">"es2017"</span>,
    <span class="hljs-attr">"module"</span>: <span class="hljs-string">"commonjs"</span>,
    <span class="hljs-attr">"experimentalDecorators"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"emitDecoratorMetadata"</span>: <span class="hljs-literal">true</span>
  }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="bootstrap-application"></a><a href="#bootstrap-application" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bootstrap Application</h2>
<p>The bootstrap application consists of two steps: initialization and listen to the port for incoming http request.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">new</span> Plumier()
    .set(<span class="hljs-keyword">new</span> WebApiFacility())
    .initialize()
    .then(<span class="hljs-function"><span class="hljs-params">koa</span> =&gt;</span> koa.listen(<span class="hljs-number">8000</span>))
    .catch(<span class="hljs-built_in">console</span>.error)
</code></pre>
<p>Facility is a component used to configure Plumier application to add a new functionalities. It consist of ordered middlewares, some initialization process before the application started and some application configuration. Plumier provided some facilities for development convenient.</p>
<table>
<thead>
<tr><th>Facility</th><th>Includes</th><th>Package</th></tr>
</thead>
<tbody>
<tr><td><code>WebApiFacility</code></td><td>Body parser, CORS middleware, Default dependency resolver</td><td><code>plumier</code></td></tr>
<tr><td><code>JwtAuthFacility</code></td><td>Jwt middleware, Enable authorization, Jwt Secret configuration</td><td><code>@plumier/jwt</code></td></tr>
<tr><td><code>MongooseFacility</code></td><td>Mongoose schema generator, Schema analyzer, Connection management</td><td><code>@plumier/mongoose</code></td></tr>
<tr><td><code>MultiPartFacility</code></td><td>Multipart file parser</td><td><code>@plumier/multipart</code></td></tr>
<tr><td><code>ServeStaticFacility</code></td><td>Serve static files middleware</td><td><code>@plumier/serve-static</code></td></tr>
</tbody>
</table>
<h2><a class="anchor" aria-hidden="true" id="controller"></a><a href="#controller" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controller</h2>
<p>The term of Controller in Plumier is the same as in other MVC framework. Controller is a group of actions handled the request. Controller should follow a simple rules</p>
<ol>
<li>Controller name should be ends with <code>Controller</code>, for example <code>UsersController</code></li>
<li>By default controller files should be put inside directory named <code>controller</code> in the same level with the bootstrap application file. But this behavior can be change by specifying the directory <code>new WebApiFacility({ controller: join(__dirname, &lt;new location&gt;) })</code></li>
</ol>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">import</span> {route} <span class="hljs-keyword">from</span> <span class="hljs-string">"plumier"</span>

<span class="hljs-comment">//file: ./controller/animal-controller.ts</span>
<span class="hljs-keyword">class</span> AnimalsController {
    <span class="hljs-meta">@rest</span>.get()
    <span class="hljs-keyword">get</span>() { }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="basic-routing"></a><a href="#basic-routing" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Routing</h2>
<p>Route automatically generated from controller name, method name and parameter names.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> AnimalsController {
    <span class="hljs-keyword">get</span>(id:<span class="hljs-built_in">string</span>) { }
}
</code></pre>
<pre><code class="hljs"><span class="hljs-builtin-name">GET</span> /animals/get?<span class="hljs-attribute">id</span>=123
</code></pre>
<p>Default http method used is <code>GET</code>, the controller name <code>AnimalsController</code> generated into <code>animals</code> note that the <code>Controller</code> word is removed. Method name kept intact <code>get</code>. Methods parameter <code>id</code> bound with the request query <code>id</code>.</p>
<p>Furthermore this behavior can be customized using the <code>@route</code> decorator.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">import</span> {route} <span class="hljs-keyword">from</span> <span class="hljs-string">"plumier"</span>

<span class="hljs-keyword">class</span> AnimalsController {
    <span class="hljs-meta">@route</span>.get(<span class="hljs-string">":id"</span>)
    <span class="hljs-keyword">get</span>(id:<span class="hljs-built_in">number</span>) { }

    <span class="hljs-meta">@route</span>.post(<span class="hljs-string">""</span>)
    save(data:Animal){ }

    <span class="hljs-meta">@route</span>.put(<span class="hljs-string">":id"</span>)
    modify(id:<span class="hljs-built_in">number</span>, data:Animal){ }
}
</code></pre>
<pre><code class="hljs">GET  <span class="hljs-string">/animals/</span><span class="hljs-function">:id</span>
POST <span class="hljs-string">/animals</span>
PUT  <span class="hljs-string">/animals/</span><span class="hljs-function">:id</span>
</code></pre>
<p>String parameter passed into the route parameter <code>@route.get(&quot;:id&quot;)</code> will rename the method name, thus its become <code>GET /animals/:id</code>, note that the controller name kept intact <code>animals</code>, the <code>get</code> method name changed into <code>:id</code>.</p>
<p>When empty string provided <code>@route.post(&quot;&quot;)</code> the method name will be ignored, thus its become <code>POST /animals</code>, note the <code>save</code> method name ignored from the url.</p>
<p>This behavior enable Plumier to construct more flexible route such as nested route easily, refer to <a href="refs/route">route generation cheat sheet</a> for more information.</p>
<h2><a class="anchor" aria-hidden="true" id="basic-parameter-binding"></a><a href="#basic-parameter-binding" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Parameter Binding</h2>
<p>To access request values (body, headers, cookie etc) from inside controllers, Plumier provided parameter binding to automatically bound request value into parameters. Plumier parameter binding uses reflection library to extract controller metadata that make it possible to bound method parameter using convention over configuration and minimize the usage of decorators.</p>
<p>Parameter binding add an extra step before bound the request values into the method parameters:</p>
<ol>
<li>Converter its provide data conversion into the exact parameter type.</li>
<li>Validator its automatically validate the value if the validation decorator provided.</li>
<li>Authorization (optional) its check for parameter access if enabled.</li>
</ol>
<p>Plumier supported three kind of parameter binding. Its applied into method's parameter using priority.</p>
<ol>
<li>Decorator parameter binding (highest priority). Decorator parameter binding use special decorator <code>@bind</code>.</li>
<li>Name parameter binding (medium priority). Apply request values based on name.</li>
<li>Model parameter binding (lowest priority). Apply request body into parameter where the parameter type is a class that its property match with request body properties.</li>
</ol>
<p>Using above rule having controller below</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> AnimalsController {
    <span class="hljs-meta">@route</span>.get()
    <span class="hljs-keyword">get</span>(species:<span class="hljs-built_in">string</span>){}
}
</code></pre>
<p>By issuing <code>GET /animals/get?species=canine</code> will automatically bound the <code>species</code> parameter of the query string into the <code>species</code> parameter of the method, using Name Parameter Binding.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> AnimalsController {
    <span class="hljs-meta">@route</span>.get()
    <span class="hljs-keyword">get</span>(<span class="hljs-meta">@bind</span>.header(<span class="hljs-string">"x-forwarded-proto"</span>) forward:<span class="hljs-built_in">string</span>){}
}
</code></pre>
<p>Above code will bound the <code>forward</code> parameter with request header <code>x-forwarded-proto</code> using Decorator Parameter Binding</p>
<pre><code class="hljs css language-typescript"><span class="hljs-meta">@domain</span>()
<span class="hljs-keyword">class</span> Animal {
    <span class="hljs-keyword">constructor</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> name:<span class="hljs-built_in">string</span>,
        <span class="hljs-keyword">public</span> active:<span class="hljs-built_in">boolean</span>,
        <span class="hljs-keyword">public</span> dateOfBirth:<span class="hljs-built_in">Date</span>
    </span>)
}

class AnimalsController {
    <span class="hljs-meta">@route</span>.post(<span class="hljs-string">""</span>)
    save(data:Animal){ }
}
</code></pre>
<p>By issuing <code>POST /animals</code> with a request body <code>{ &quot;name&quot;: &quot;Mimi&quot;, &quot;active&quot;: &quot;Yes&quot;, &quot;dateOfBirth&quot;: &quot;2018-12-3&quot; }</code> will automatically bound the request body into the <code>data</code> parameter using Model Parameter Binding, because <code>data</code> is a custom class and doesn't have any decorator nor match any request name.</p>
<p>Note that using above code, the request body automatically converted into <code>Animal</code> class including all its properties <code>&quot;active&quot;: &quot;Yes&quot;</code> automatically converted into <code>active: true</code>, <code>&quot;dateOfBirth&quot;: &quot;2018-12-3&quot;</code> converted into <code>dateOfBirth: new Date(&quot;2018-12-3&quot;)</code></p>
<h2><a class="anchor" aria-hidden="true" id="type-conversion-limitation"></a><a href="#type-conversion-limitation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Type Conversion Limitation</h2>
<p>Due to TypeScript reflection limitation in some case type conversion will not work in parameter binding like expected. Plumier use its own reflection library named <a href="https://github.com/plumier/tinspector">TInspector</a>. It uses TypeScript <code>experimentalDecorators</code> and <code>emitDecoratorMetadata</code> to get the type information such as type name, method name, methods parameter names etc during runtime.</p>
<p><code>emitDecoratorMetadata</code> configuration tells TypeScript compiler to add type information only on decorated class. This limitation also affect TInspector ability:</p>
<ol>
<li>Will not able to get type information of an interface</li>
<li>Will not able to get type information of a class without decorator. It can get name information of class, method, property and parameters but unable to get its data type.</li>
<li>Will not able to get type information of complex class such as generic type : <code>Array&lt;User&gt;</code>, <code>Partial&lt;User&gt;</code> or even <code>Promise&lt;User&gt;</code></li>
</ol>
<p>By having an understanding of above limitation, then you will understand that below controller will not work like expected.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> DataController {
    <span class="hljs-keyword">get</span>(num:<span class="hljs-built_in">number</span>){
        <span class="hljs-keyword">return</span> { num }
    }
}
<span class="hljs-comment">// below request is valid </span>
<span class="hljs-comment">// GET /data/get?num=hello </span>
</code></pre>
<p>By issuing <code>GET /data/get?num=hello</code> won't make Plumier response error, because converter unable to get the type information of the <code>num</code> parameter. This issue can be fixed by adding any decorator on the <code>get</code> method</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> DataController {
    <span class="hljs-meta">@route</span>.get()
    <span class="hljs-keyword">get</span>(num:<span class="hljs-built_in">number</span>){
        <span class="hljs-keyword">return</span> { num }
    }
}
<span class="hljs-comment">// below request returned response error</span>
<span class="hljs-comment">// GET /data/get?num=hello </span>
</code></pre>
<p>By providing <code>@route.get()</code> decorator TypeScript will add type information on the <code>num</code> parameter that make issuing <code>GET /data/get?num=hello</code> will make Plumier response an error properly.</p>
<p>If you're good static type programmer than you'll notice that Plumier uses class as domain model instead of interface. Example below uses interface as the domain model and due to reflection limitation on interface below example will not work like expected.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">interface</span> User {
    name:<span class="hljs-built_in">string</span>,
    dateOfBirth:<span class="hljs-built_in">Date</span>,
    active:<span class="hljs-built_in">boolean</span>
}

<span class="hljs-keyword">class</span> UsersController {
    <span class="hljs-meta">@route</span>.post(<span class="hljs-string">""</span>)
    save(user:User){ }
}
</code></pre>
<p>Even if you provide <code>@route.post(&quot;&quot;)</code> decorator TypeScript will not add information about property type of the <code>User</code> domain above. Thus issuing request below will not causing response error.</p>
<pre><code class="hljs">POST <span class="hljs-built_in">/users
</span>{ 
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Mimi"</span>, 
    <span class="hljs-string">"dateOfBirth"</span>: 123, 
    <span class="hljs-string">"active"</span>: <span class="hljs-string">"lorem ipsum"</span> 
}
</code></pre>
<p>To fix above issue use a class as domain model decorated with <code>@domain()</code> decorator like below</p>
<pre><code class="hljs css language-typescript"><span class="hljs-meta">@domain</span>()
<span class="hljs-keyword">class</span> User {
    <span class="hljs-keyword">constructor</span>(<span class="hljs-params">
        <span class="hljs-keyword">public</span> name:<span class="hljs-built_in">string</span>,
        <span class="hljs-keyword">public</span> dateOfBirth:<span class="hljs-built_in">Date</span>,
        <span class="hljs-keyword">public</span> active:<span class="hljs-built_in">boolean</span>
    </span>){}
}

<span class="hljs-keyword">class</span> UsersController {
    <span class="hljs-meta">@route</span>.post(<span class="hljs-string">""</span>)
    save(user:User){ }
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="basic-validation"></a><a href="#basic-validation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Basic Validation</h2>
<p>Plumier validation checked automatically before the controller executed. Plumier provided comprehensive decorator based validation functionalities. Decorator can be applied directly on the parameter or in the domain properties.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">import</span> { val } <span class="hljs-keyword">from</span> <span class="hljs-string">"plumier"</span>

<span class="hljs-keyword">class</span> AuthController {
    <span class="hljs-meta">@route</span>.post()
    login(<span class="hljs-meta">@val</span>.email() email:<span class="hljs-built_in">string</span>, password:<span class="hljs-built_in">string</span>){}
}
</code></pre>
<p>Above code showing that the <code>@val.email()</code> validator applied into the parameter directly. Using controller above when API consumer provided invalid email address the response with status 422 automatically returned without having to touch the controller. This is an intended behavior because further you can create your own custom validator easily.</p>
<p><code>@val</code> decorator can be applied anywhere on the domain property in a deep nested children.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">import</span> { val } <span class="hljs-keyword">from</span> <span class="hljs-string">"plumier"</span>

<span class="hljs-meta">@domain</span>()
<span class="hljs-keyword">class</span> Login {
    <span class="hljs-keyword">constructor</span>(<span class="hljs-params">
        <span class="hljs-meta">@val</span>.email()
        <span class="hljs-keyword">public</span> email:<span class="hljs-built_in">string</span>,
        <span class="hljs-keyword">public</span> password:<span class="hljs-built_in">string</span>
    </span>){}
}

<span class="hljs-keyword">class</span> AuthController {
    <span class="hljs-meta">@route</span>.post()
    login(data:Login){}
}
</code></pre>
<p>Above code have the same behavior with the previous one, but showing that the validation now moved into a class property.</p>
<h2><a class="anchor" aria-hidden="true" id="authorization"></a><a href="#authorization" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Authorization</h2>
<p>Plumier provided authorization decorator to easily securing access to the endpoints. This functionality automatically enabled when the <code>JwtAuthFacility</code> installed on Plumier application. Once installed all endpoints secured (not accessible by non login user) except decorated with <code>@authorize.public()</code></p>
<p>Plumier authorization required a valid JWT key passed within the <code>Authorization</code> header or a cookie named <code>Authorization</code>, Plumier automatically returned back response with status code:</p>
<ol>
<li>403 (Forbidden) If JWT key not provided in header or cookie, except the endpoint mark with <code>@authorize.public()</code>.</li>
<li>401 (Unauthorized) If current login user Role doesn't match with authorized endpoint specified in <code>@authorize.role(&lt;allowed role&gt;)</code>.</li>
</ol>
<p><code>JwtAuthFacility</code> automatically verify the JWT and check the <code>role</code> property inside the JWT Claim if its match with the accessed role described by the <code>@authorize.role(&lt;allowed role&gt;)</code>. Example of valid JWT Claim:</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">import</span> {sign} <span class="hljs-keyword">from</span> <span class="hljs-string">"jsonwebtoken"</span>

<span class="hljs-keyword">const</span> token = sign({ userId: &lt;id&gt;, role: <span class="hljs-string">"User"</span> }, process.env.JWT_SECRET)
</code></pre>
<p>Note that the <code>role</code> property is required, it can be a <code>string</code> or <code>string[]</code>.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> AnimalsController {
    <span class="hljs-meta">@authorize</span>.role(<span class="hljs-string">"Admin"</span>, <span class="hljs-string">"User"</span>)
    <span class="hljs-meta">@route</span>.get(<span class="hljs-string">":id"</span>)
    <span class="hljs-keyword">get</span>(id:<span class="hljs-built_in">string</span>){ }

    <span class="hljs-meta">@authorize</span>.role(<span class="hljs-string">"Admin"</span>)
    <span class="hljs-meta">@route</span>.post(<span class="hljs-string">""</span>)
    save(data:Animal){ }
}
</code></pre>
<table>
<thead>
<tr><th>Route</th><th>Access</th></tr>
</thead>
<tbody>
<tr><td><code>GET /animals/:id</code></td><td>Admin or User</td></tr>
<tr><td><code>POST /animals</code></td><td>Admin only</td></tr>
</tbody>
</table>
<p>Go to the <a href="refs/authorization">Authorization</a> for more information.</p>
<h2><a class="anchor" aria-hidden="true" id="controller-return-value"></a><a href="#controller-return-value" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Controller Return Value</h2>
<p>Controller's return value by default will rendered into JSON response with status code 200. Controller allowed to returned value or promised value.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> AnimalController {
    <span class="hljs-meta">@route</span>.get(<span class="hljs-string">":id"</span>)
    <span class="hljs-keyword">get</span>(id:<span class="hljs-built_in">string</span>){
        <span class="hljs-comment">//return static value</span>
        <span class="hljs-keyword">return</span> { name: <span class="hljs-string">"Mimi"</span> }
    }
}
</code></pre>
<p>Or return promised value returned by database library</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> AnimalController {
    <span class="hljs-meta">@route</span>.get(<span class="hljs-string">":id"</span>)
    <span class="hljs-keyword">get</span>(id:<span class="hljs-built_in">string</span>){
        <span class="hljs-comment">// mongoose model</span>
        <span class="hljs-keyword">return</span> AnimalModel.findById(id)
    }
}
</code></pre>
<p>For more advanced result, controller should returned any object derived from <code>ActionResult</code> class. Using <code>ActionResult</code> possibly to set more advanced response values such as cookie, header etc.</p>
<pre><code class="hljs css language-typescript"><span class="hljs-keyword">class</span> AnimalController {
    <span class="hljs-meta">@route</span>.get(<span class="hljs-string">":id"</span>)
    <span class="hljs-keyword">get</span>(id:<span class="hljs-built_in">string</span>){
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActionResult({ name: <span class="hljs-string">"Mimi"</span> })
            .setCookie(<span class="hljs-string">"Name"</span>, <span class="hljs-string">"Value"</span>)
    }
}
</code></pre>
<p>Plumier provided several <code>ActionResult</code> derived class for development convenient.</p>
<table>
<thead>
<tr><th>Action</th><th>Alias</th><th>Description</th><th>Package</th></tr>
</thead>
<tbody>
<tr><td><code>ActionResult</code></td><td><code>response.json()</code></td><td>Return json response</td><td><code>plumier</code></td></tr>
<tr><td><code>RedirectActionResult</code></td><td><code>response.redirect()</code></td><td>Redirect response</td><td><code>plumier</code></td></tr>
<tr><td><code>FileActionResult</code></td><td><code>response.file()</code></td><td>Serve static file response</td><td><code>@plumier/serve-static</code></td></tr>
</tbody>
</table>
<p>Refer to <a href="refs/action-result">action result documentation</a> for more information.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/motivation"><span class="arrow-prev">← </span><span>Motivation</span></a><a class="docs-next button" href="/docs/extend"><span>Extending Plumier</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#basic-framework-skeleton">Basic Framework Skeleton</a></li><li><a href="#minimum-typescript-configuration">Minimum TypeScript Configuration</a></li><li><a href="#bootstrap-application">Bootstrap Application</a></li><li><a href="#controller">Controller</a></li><li><a href="#basic-routing">Basic Routing</a></li><li><a href="#basic-parameter-binding">Basic Parameter Binding</a></li><li><a href="#type-conversion-limitation">Type Conversion Limitation</a></li><li><a href="#basic-validation">Basic Validation</a></li><li><a href="#authorization">Authorization</a></li><li><a href="#controller-return-value">Controller Return Value</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2020 Plumier</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'cc5032f20c325b27c07de03fe7078651',
                indexName: 'plumierjs',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>